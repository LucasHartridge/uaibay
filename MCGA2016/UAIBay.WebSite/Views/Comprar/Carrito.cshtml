@model IEnumerable<UAIBay.WebSite.ViewModel.ItemCarritoViewModels>

@{
    ViewBag.Title = "Carrito";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<section id="cart_items">

<<<<<<< HEAD
<<<<<<< HEAD
<h2>Carrito</h2>

<table class="table" id="tableId">
    <thead>
=======
    @*<h2>Carrito</h2>*@
=======
>>>>>>> premaster
    <div class="review-payment">
        <h2>@UAIBay.WebSite.Resources.Recurso.Carrito</h2>
    </div>
<<<<<<< HEAD
    @*<table class="table" id="TablaCarrito">
>>>>>>> premaster
        <tr>
            <th>
                @Html.DisplayName("Nombre del producto")
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Cantidad)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Precio)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Subtotal)
            </th>
            <th></th>
<<<<<<< HEAD
        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model)
        {
          
            <tr id=@item.CodProducto>
                <td id="NombreProducto">
                    @Html.DisplayFor(modelItem => item.Producto.Descripcion)
                </td>

                <td id="CantidadProducto">
                    <a href="#" class="btn btn-flat" id="restar"><i class="fa fa-minus-circle " style="margin:auto 0"></i></a>
                    @Html.TextBoxFor(modelItem => item.Cantidad, new { id = "cantidad" })
                    <a href="#" class="btn btn-flat" id="sumar"><i class="fa fa-plus-circle" style="margin:auto 0"></i></a>
                </td>
                <td>
                    $ @Html.DisplayFor(modelItem => item.Precio)
                </td>
                <td>
                    $ @Html.DisplayFor(modelItem => item.Subtotal)
                </td>

                <td>
                    @Html.ActionLink("Quitar producto", "QuitarItem", new { codProducto = item.CodProducto, nroCarrito = item.IdCarrito })
                </td>
            </tr>
        }
    </tbody>

=======
        </tr>*@
=======
    
>>>>>>> premaster
    <div class="table-responsive cart_info">
        <table class="table table-condensed" id="TablaCarrito">
            <thead>
                <tr class="cart_menu">
                    <th>
                        @Html.DisplayName(@UAIBay.WebSite.Resources.Recurso.Nombre)
                    </th>
                    <th>
                        @Html.DisplayName(@UAIBay.WebSite.Resources.Recurso.Cantidad)
                    </th>
                    <th>
                        @Html.DisplayName(@UAIBay.WebSite.Resources.Recurso.Precio)
                    </th>
                    <th>
                        @Html.DisplayName(@UAIBay.WebSite.Resources.Recurso.SubTotal)
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr class="targetfields">
                        <td>
                            <h4> @Html.DisplayFor(modelItem => item.Producto.Descripcion)</h4>
                        </td>
                        <td>

                            <a href="#" class="restar"><i class="fa fa-minus-circle " style="margin:auto 0"></i></a>

                            @Html.TextBoxFor(modelItem => item.Cantidad, new { @class = "cantidad", id = "cantidad", @readonly = true })


                            <a href="#" class="sumar"><i class="fa fa-plus-circle" style="margin:auto 0"></i></a>

                        </td>
                        <td>
                            $ @Html.TextBoxFor(modelItem => item.Precio, new { @class = "precio", @readonly = true, id = "precio" })
                        </td>
                        <td class="tdsubtotal">
                            $ @Html.TextBoxFor(modelItem => item.Subtotal, new { @class = "subtotal", @readonly = true, id = "subtotal" })
                        </td>

                        <td>
                            <a href='@(Url.Action("QuitarItem", "Comprar",new { codProducto = item.CodProducto, nroCarrito = item.IdCarrito }))'><i class="fa fa-times"></i></a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</section>
<section id="do_action">
    <div class="container">
        <div class="heading">
            <h3>@UAIBay.WebSite.Resources.Recurso.ConfirmeSuCompra</h3>
            <p>@UAIBay.WebSite.Resources.Recurso.RecuerdeEnviosZonaOeste.</p>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="chose_area">
                    <ul class="user_option">
                        <li class="user_info">
                            <label>@UAIBay.WebSite.Resources.Recurso.IngreseSuCodigoDeDescuento</label>
                            @Html.TextBox("cod", null)
                        </li>
                    </ul>
                    <ul class="user_option">
                        <li class="user_info">
                            <label >@UAIBay.WebSite.Resources.Recurso.SeleccioneSuDireccion</label>
                            <select>
                                <option value="Arias">Localidad: Morón,Direccion: Arias 1235,Cod.Postal: 1712</option>
                                <option value="Sarmiento">Localidad: Morón,Direccion: Sarmiento 1501,Cod.Postal: 1712</option>
                                <option value="Alem">Localidad: Morón,Direccion: Alem 1234,Cod.Postal: 1712</option>
                                <option value="Santa Rosa">Localidad: Morón,Direccion: Santa Rosa,Cod.Postal: 1712</option>
                            </select>
                        </li>
                    </ul>
                    <ul class="user_option">
                        <li class="user_info">
                            <center><label style="color:#FE980F">@UAIBay.WebSite.Resources.Recurso.O</label></center>
                        </li>
                    </ul>
                    <ul class="user_info">
                        <li class="user_option">
                            <label>@UAIBay.WebSite.Resources.Recurso.AgregueUnaNuevaDireccion</label>
                        </li>
                    </ul>
                    <ul class="user_info">
                        <li class="single_field zip-field">
                            <label>@UAIBay.WebSite.Resources.Recurso.Partido:</label>
                            <input type="text" style="background:#F0F0E9">
                        </li>
                        <li class="single_field zip-field">
                            <label>@UAIBay.WebSite.Resources.Recurso.Dirección:</label>
                            <input type="text" style="background:#F0F0E9">
                        </li>
                        <li class="single_field zip-field">
                            <label>@UAIBay.WebSite.Resources.Recurso.CodigoPostal:</label>
                            <input type="text" style="background:#F0F0E9">
                        </li>
                        <li >
                            <button class ="btn btn-default check_out">@UAIBay.WebSite.Resources.Recurso.Agregar</button>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="total_area">
                    <ul>
                        <li>@UAIBay.WebSite.Resources.Recurso.SubTotal <span>$<input type="text" id="subtotalcarrito" value="1" readonly="readonly" /></span></li>
                        <li>@UAIBay.WebSite.Resources.Recurso.CostoDeEnvio <span id="enviogratis">@UAIBay.WebSite.Resources.Recurso.Gratis</span></li>
                        <li>@UAIBay.WebSite.Resources.Recurso.Total <span>$<input value="0" readonly="readonly" id="totalcarrito" /></span></li>
                    </ul>
                    <a href='@(Url.Action("Comprar", "Comprar", new { nroCarrito = ViewBag.Carrito, codDescuento = "" }))' class="btn btn-default update">@UAIBay.WebSite.Resources.Recurso.Comprar</a>
                    <a href='@(Url.Action("Catalogo", "Comprar"))' class="btn btn-default check_out">@UAIBay.WebSite.Resources.Recurso.VolverAlCatalogo</a>
                </div>
            </div>
        </div>
    </div>
</section>
<<<<<<< HEAD
@*@foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Producto.Descripcion)
                </td>
                <td>

                    <a href="#" class="restar"><i class="fa fa-minus-circle " style="margin:auto 0"></i></a>

                    @Html.TextBoxFor(modelItem => item.Cantidad, new { @class = "cantidad", id = "cantidad", @readonly = true })


                    <a href="#" class="sumar"><i class="fa fa-plus-circle" style="margin:auto 0"></i></a>
>>>>>>> premaster

                </td>
                <td class="tdprecio">
                    $ @Html.TextBoxFor(modelItem => item.Precio, new { @class = "precio", @readonly = true, id = "precio" })
                </td>
                <td class="tdsubtotal">
                    $ @Html.TextBoxFor(modelItem => item.Subtotal, new { @class = "subtotal", @readonly = true, id = "subtotal" })
                </td>

                <td>
                    @Html.ActionLink("Quitar producto", "QuitarItem", new { codProducto = item.CodProducto, nroCarrito = item.IdCarrito })
                </td>
            </tr>
        }

    </table>*@


@*@Html.Label("Código de descuento:")
    @Html.TextBox("cod", null, new { placeholder = "Ingrese el código de descuento" })
    @Html.ActionLink("COMPRAR", "Comprar", new { nroCarrito = ViewBag.Carrito, codDescuento = "" }, new { @class = "btn btn-warning" })

    <p>
        @Html.ActionLink("Volver al catálogo", "Catalogo")
    </p>*@
=======
>>>>>>> premaster


<script src="~/Scripts/jquery-1.10.2.min.js"></script>

<script type="text/javascript">
<<<<<<< HEAD

    //$(document).ready(function () {
    //    $('#restar').click(function () {
    //        //get txtAmt value
    //        var valorProducto = $('#cantidad').val();
    //        //var valorProducto = $('.cantidad').val();

    //        valorProducto -= 1;

    //        if (valorProducto < 1) {

    //        }
    //        else {
    //            //change txtInterest% value
    //            $('#cantidad').val(valorProducto);
    //        }

    //    });
    //});

    //$(document).ready(function () {
    //    $('#sumar').click(function () {
    //        //get txtAmt value
    //        var valorProducto = $('#cantidad').val();
    //        valorProducto = parseInt(1) + parseInt(valorProducto);

    //        if (valorProducto > 9) {}
    //        else {
    //            //change txtInterest% value
    //            $('#cantidad').val(valorProducto);
    //        }
    //    });
    //});








    //function calculate(obj) {
    //    var price = parseFloat($(obj).parent().parent().parent().find('.cantidad').text()) || 0;
    //    var quantity = parseInt($(obj).parent().find('.cantidad').val());
    //    //var total = price * quantity;
    //    $(obj).parent().parent().parent().find('.cantidad').text(quantity);;

    //    var subtotal = parseFloat($(obj).parent().parent().parent().find('.subtotal').val());
    //    var precio = parseFloat($(obj).parent().parent().parent().find('.precio').val());
    //    var subtotalactualizado = precio * quantity;
    //    $(obj).parent().parent().parent().find('.subtotal').text(subtotalactualizado);;
    //}


    

=======
>>>>>>> premaster
    function calcularTotal() {
        var total = 0;
        $('#TablaCarrito .targetfields').each(function () {
            var subtotal = parseInt($(this).find(".subtotal").val());
            total = total + subtotal;
        });
        $('#subtotalcarrito').val(total);
        $('#totalcarrito').val(total);
    }

    function changeQuantity(num, obj) {
        var value_to_set = parseInt($(obj).parent().find('.cantidad').val()) + num;
        if (value_to_set <= 1) { $(obj).parent().find('.cantidad').val(1); return; }
        if (value_to_set > 9) { $(obj).parent().find('.cantidad').val(9); return; }
        $(obj).parent().find('.cantidad').val(value_to_set);
    }

    function changeSubTotal(obj) {
        var $tr = $(obj).parents("tr");
        var precio = $tr.find("td").eq(2).find('.precio').val();
        var subtotal = $tr.find("td").eq(3).find('.subtotal').val();
        var quantity = parseInt($(obj).parent().parent().find('.cantidad').val());
        var subtotalactualizado = precio * quantity;
        $tr.find("td").eq(3).find('.subtotal').val(subtotalactualizado);        
    }


    $().ready(function () {
        var total = 0;
        $('#TablaCarrito .targetfields').each(function () {
            var subtotal = parseInt($(this).find(".subtotal").val());
            total = total + subtotal;
        });
        $('#subtotalcarrito').val(total);
        $('#totalcarrito').val(total);

        $(".restar").click(function () {
            changeQuantity(-1, this);
            changeSubTotal(this);
            calcularTotal();
        });

        $(".sumar").click(function () {
            changeQuantity(1, this);
            changeSubTotal(this);
            calcularTotal();
<<<<<<< HEAD
            //calculate(this);
        });

        //$(".cantidad").keyup(function (e) {
        //    if (e.keyCode == 38) changeQuantity(1, this);
        //    if (e.keyCode == 40) changeQuantity(-1, this);
        //    calculate(this);
        //});

=======
>>>>>>> premaster

        })
    });
</script>
